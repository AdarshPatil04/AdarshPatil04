name: Update PR Summary (minimal, validated)

on:
  workflow_dispatch:

jobs:
  update:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: read

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Ensure gh installed
        run: |
          if ! command -v gh >/dev/null 2>&1; then
            sudo apt-get update -y
            sudo apt-get install -y gh || true
          fi
          gh --version || true

      - name: Fetch PRs (test)
        env:
          REPO: ${{ github.repository }}
        run: |
          gh api -H "Accept: application/vnd.github+json" /repos/"$REPO"/pulls?state=all&per_page=5 > pr_list.json || true
          echo "pr_list.json size: $(wc -c pr_list.json 2>/dev/null || true)"
          head -n 5 pr_list.json || true

      - name: Commit (no-op)
        run: |
          echo "workflow completed"
